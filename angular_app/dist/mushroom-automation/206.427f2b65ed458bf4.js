"use strict";(self.webpackChunkmushroom_automation=self.webpackChunkmushroom_automation||[]).push([[206],{1206:(je,_,d)=>{d.r(_),d.d(_,{ReportsComponent:()=>ke});var c=d(177),a=d(9417),F=d(1413),w=d(8359);class y extends w.yU{constructor(n,t){super()}schedule(n,t=0){return this}}const m={setInterval(s,n,...t){const{delegate:r}=m;return r?.setInterval?r.setInterval(s,n,...t):setInterval(s,n,...t)},clearInterval(s){const{delegate:n}=m;return(n?.clearInterval||clearInterval)(s)},delegate:void 0};var C=d(7908),j=d(6129);class h{constructor(n,t=h.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,r){return new this.schedulerActionCtor(this,n).schedule(r,t)}}h.now=j.U.now;const v=new class M extends h{constructor(n,t=h.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,r){for(;n=t.shift();)n.unsubscribe();throw r}}}(class k extends y{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var r;if(this.closed)return this;this.state=n;const o=this.id,i=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(i,o,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,t),this}requestAsyncId(n,t,r=0){return m.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&m.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(n,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let o,r=!1;try{this.work(n)}catch(i){r=!0,o=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,C.o)(r,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}),R=v;var E=d(1985),D=d(9470);var $=d(6977),G=d(5558),e=d(540);function N(s,n){if(1&s&&(e.j41(0,"option",13),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.client_id),e.R7$(1),e.SpI(" ",t.name," ")}}function V(s,n){if(1&s&&(e.j41(0,"option",13),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function B(s,n){if(1&s&&(e.j41(0,"option",13),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}let Y=(()=>{class s{constructor(){this.selectedDataType="",this.selectedFormat="",this.selectedClient="",this.clients=[],this.selectedClientChange=new e.bkB,this.selectedDataTypeChange=new e.bkB,this.selectedFormatChange=new e.bkB,this.filtersCleared=new e.bkB,this.dataTypeOptions=[{value:"",label:"Todos los tipos"},{value:"sensors",label:"Sensores"},{value:"events",label:"Eventos"},{value:"actuators",label:"Actuadores"}],this.formatOptions=[{value:"",label:"Todos los formatos"},{value:"json",label:"JSON"},{value:"csv",label:"CSV"}]}onClientChange(t){this.selectedClientChange.emit(t)}onDataTypeChange(t){this.selectedDataTypeChange.emit(t)}onFormatChange(t){this.selectedFormatChange.emit(t)}clearFilters(){this.selectedDataType="",this.selectedFormat="",this.selectedClient="",this.filtersCleared.emit()}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-report-filters"]],inputs:{selectedDataType:"selectedDataType",selectedFormat:"selectedFormat",selectedClient:"selectedClient",clients:"clients"},outputs:{selectedClientChange:"selectedClientChange",selectedDataTypeChange:"selectedDataTypeChange",selectedFormatChange:"selectedFormatChange",filtersCleared:"filtersCleared"},standalone:!0,features:[e.aNF],decls:21,vars:6,consts:[[1,"grid","grid-cols-1","md:grid-cols-4","gap-5","items-end"],[1,"space-y-2"],["for","clientFilter",1,"block","text-sm","font-medium","text-gray-700"],["id","clientFilter",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","dataTypeFilter",1,"block","text-sm","font-medium","text-gray-700"],["id","dataTypeFilter",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],["for","formatFilter",1,"block","text-sm","font-medium","text-gray-700"],["id","formatFilter",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],[1,"space-y-2","flex","justify-end"],[1,"px-5","py-2.5","bg-gray-100","hover:bg-gray-200","text-gray-700","rounded-lg","shadow-sm","transition-all","duration-200","font-medium","flex","items-center",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","mr-2"],["fill-rule","evenodd","d","M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule","evenodd"],[3,"value"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"label",2),e.EFF(3,"Cliente"),e.k0s(),e.j41(4,"select",3),e.bIt("ngModelChange",function(l){return o.onClientChange(l)}),e.DNE(5,N,2,2,"option",4),e.k0s()(),e.j41(6,"div",1)(7,"label",5),e.EFF(8,"Tipo de Datos"),e.k0s(),e.j41(9,"select",6),e.bIt("ngModelChange",function(l){return o.onDataTypeChange(l)}),e.DNE(10,V,2,2,"option",4),e.k0s()(),e.j41(11,"div",1)(12,"label",7),e.EFF(13,"Formato"),e.k0s(),e.j41(14,"select",8),e.bIt("ngModelChange",function(l){return o.onFormatChange(l)}),e.DNE(15,B,2,2,"option",4),e.k0s()(),e.j41(16,"div",9)(17,"button",10),e.bIt("click",function(){return o.clearFilters()}),e.qSk(),e.j41(18,"svg",11),e.nrm(19,"path",12),e.k0s(),e.EFF(20," Limpiar Filtros "),e.k0s()()()),2&r&&(e.R7$(4),e.Y8G("ngModel",o.selectedClient),e.R7$(1),e.Y8G("ngForOf",o.clients),e.R7$(4),e.Y8G("ngModel",o.selectedDataType),e.R7$(1),e.Y8G("ngForOf",o.dataTypeOptions),e.R7$(4),e.Y8G("ngModel",o.selectedFormat),e.R7$(1),e.Y8G("ngForOf",o.formatOptions))},dependencies:[c.MD,c.Sq,a.YN,a.xH,a.y7,a.wz,a.BC,a.vS],encapsulation:2})}}return s})();function L(s,n){if(1&s&&(e.j41(0,"option",22),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function A(s,n){if(1&s&&(e.j41(0,"option",22),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function X(s,n){if(1&s){const t=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h3",4),e.EFF(4,"Generar Nuevo Reporte"),e.k0s(),e.j41(5,"button",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onCloseModal())}),e.qSk(),e.j41(6,"svg",6),e.nrm(7,"path",7),e.k0s()()(),e.joV(),e.j41(8,"div",8)(9,"div",9)(10,"label",10),e.EFF(11,"Fecha Inicio"),e.k0s(),e.j41(12,"input",11),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.reportFormData.start_date=o)}),e.k0s()(),e.j41(13,"div",9)(14,"label",12),e.EFF(15,"Fecha Fin"),e.k0s(),e.j41(16,"input",13),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.reportFormData.end_date=o)}),e.k0s()(),e.j41(17,"div",9)(18,"label",14),e.EFF(19,"Tipo de Datos"),e.k0s(),e.j41(20,"select",15),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.reportFormData.data_type=o)}),e.DNE(21,L,2,2,"option",16),e.k0s()(),e.j41(22,"div",9)(23,"label",17),e.EFF(24,"Formato"),e.k0s(),e.j41(25,"select",18),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.reportFormData.format=o)}),e.DNE(26,A,2,2,"option",16),e.k0s()()(),e.j41(27,"div",19)(28,"button",20),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onCloseModal())}),e.EFF(29," Cancelar "),e.k0s(),e.j41(30,"button",21),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onGenerateReport())}),e.EFF(31," Generar "),e.k0s()()()()}if(2&s){const t=e.XpG();e.R7$(12),e.Y8G("ngModel",t.reportFormData.start_date),e.R7$(4),e.Y8G("ngModel",t.reportFormData.end_date),e.R7$(4),e.Y8G("ngModel",t.reportFormData.data_type),e.R7$(1),e.Y8G("ngForOf",t.dataTypeOptions),e.R7$(4),e.Y8G("ngModel",t.reportFormData.format),e.R7$(1),e.Y8G("ngForOf",t.formatOptions)}}let O=(()=>{class s{constructor(){this.showModal=!1,this.reportFormData={start_date:"",end_date:"",data_type:"sensors",format:"json"},this.closeModal=new e.bkB,this.generateReport=new e.bkB,this.dataTypeOptions=[{value:"sensors",label:"Sensores"},{value:"events",label:"Eventos"},{value:"actuators",label:"Actuadores"}],this.formatOptions=[{value:"json",label:"JSON"},{value:"csv",label:"CSV"}]}onCloseModal(){this.closeModal.emit()}onGenerateReport(){this.generateReport.emit()}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-report-modal"]],inputs:{showModal:"showModal",reportFormData:"reportFormData"},outputs:{closeModal:"closeModal",generateReport:"generateReport"},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[["class","fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4 animate-fade-in-up",4,"ngIf"],[1,"fixed","inset-0","bg-gray-900","bg-opacity-75","flex","items-center","justify-center","z-50","p-4","animate-fade-in-up"],[1,"bg-white","rounded-xl","shadow-xl","max-w-lg","w-full","mx-auto","overflow-hidden"],[1,"bg-indigo-600","px-6","py-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","text-white"],[1,"text-white/80","hover:text-white","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6","space-y-5"],[1,"space-y-2"],["for","startDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","startDate",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],["for","endDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","endDate",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],["for","dataType",1,"block","text-sm","font-medium","text-gray-700"],["id","dataType",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","format",1,"block","text-sm","font-medium","text-gray-700"],["id","format",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],[1,"bg-gray-50","px-6","py-4","border-t","border-gray-100","flex","justify-end","gap-3"],[1,"px-5","py-2.5","bg-white","hover:bg-gray-100","text-gray-700","rounded-lg","shadow-sm","transition-all","duration-200","font-medium","border","border-gray-200",3,"click"],[1,"px-5","py-2.5","bg-indigo-600","hover:bg-indigo-700","text-white","rounded-lg","shadow-sm","transition-all","duration-200","font-medium",3,"click"],[3,"value"]],template:function(r,o){1&r&&e.DNE(0,X,32,6,"div",0),2&r&&e.Y8G("ngIf",o.showModal)},dependencies:[c.MD,c.Sq,c.bT,a.YN,a.xH,a.y7,a.me,a.wz,a.BC,a.vS],encapsulation:2})}}return s})();function z(s,n){if(1&s&&(e.j41(0,"option",27),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.client_id),e.R7$(1),e.SpI(" ",t.name," ")}}function U(s,n){if(1&s&&(e.j41(0,"option",27),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function q(s,n){if(1&s&&(e.j41(0,"option",27),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function H(s,n){if(1&s&&(e.j41(0,"option",27),e.EFF(1),e.k0s()),2&s){const t=n.$implicit;e.Y8G("value",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function J(s,n){if(1&s){const t=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h3",4),e.EFF(4,"Configurar Programador Autom\xe1tico"),e.k0s(),e.j41(5,"button",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onCloseModal())}),e.qSk(),e.j41(6,"svg",6),e.nrm(7,"path",7),e.k0s()()(),e.joV(),e.j41(8,"div",8)(9,"div",9)(10,"label",10),e.EFF(11,"Cliente"),e.k0s(),e.j41(12,"select",11),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.schedulerFormData.client_id=o)}),e.j41(13,"option",12),e.EFF(14,"Seleccione un cliente"),e.k0s(),e.DNE(15,z,2,2,"option",13),e.k0s()(),e.j41(16,"div",9)(17,"label",14),e.EFF(18,"Fecha Inicio"),e.k0s(),e.j41(19,"input",15),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.schedulerFormData.start_date=o)}),e.k0s()(),e.j41(20,"div",9)(21,"label",16),e.EFF(22,"Fecha Fin"),e.k0s(),e.j41(23,"input",17),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.schedulerFormData.end_date=o)}),e.k0s()(),e.j41(24,"div",9)(25,"label",18),e.EFF(26,"Intervalo"),e.k0s(),e.j41(27,"select",19),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.schedulerFormData.interval_hours=o)}),e.DNE(28,U,2,2,"option",13),e.k0s()(),e.j41(29,"div",9)(30,"label",20),e.EFF(31,"Tipo de Datos"),e.k0s(),e.j41(32,"select",21),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.schedulerFormData.data_type=o)}),e.DNE(33,q,2,2,"option",13),e.k0s()(),e.j41(34,"div",9)(35,"label",22),e.EFF(36,"Formato"),e.k0s(),e.j41(37,"select",23),e.bIt("ngModelChange",function(o){e.eBV(t);const i=e.XpG();return e.Njj(i.schedulerFormData.format=o)}),e.DNE(38,H,2,2,"option",13),e.k0s()()(),e.j41(39,"div",24)(40,"button",25),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onCloseModal())}),e.EFF(41," Cancelar "),e.k0s(),e.j41(42,"button",26),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onSaveScheduler())}),e.EFF(43," Guardar "),e.k0s()()()()}if(2&s){const t=e.XpG();e.R7$(12),e.Y8G("ngModel",t.schedulerFormData.client_id),e.R7$(1),e.Y8G("value",null),e.R7$(2),e.Y8G("ngForOf",t.clients),e.R7$(4),e.Y8G("ngModel",t.schedulerFormData.start_date),e.R7$(4),e.Y8G("ngModel",t.schedulerFormData.end_date),e.R7$(4),e.Y8G("ngModel",t.schedulerFormData.interval_hours),e.R7$(1),e.Y8G("ngForOf",t.intervalOptions),e.R7$(4),e.Y8G("ngModel",t.schedulerFormData.data_type),e.R7$(1),e.Y8G("ngForOf",t.dataTypeOptions),e.R7$(4),e.Y8G("ngModel",t.schedulerFormData.format),e.R7$(1),e.Y8G("ngForOf",t.formatOptions)}}let P=(()=>{class s{constructor(){this.showModal=!1,this.schedulerFormData={interval_hours:24,client_id:"",start_date:"",end_date:"",data_type:"sensors",format:"json"},this.clients=[],this.closeModal=new e.bkB,this.saveScheduler=new e.bkB,this.dataTypeOptions=[{value:"sensors",label:"Sensores"},{value:"events",label:"Eventos"},{value:"actuators",label:"Actuadores"}],this.formatOptions=[{value:"json",label:"JSON"},{value:"csv",label:"CSV"}],this.intervalOptions=[{value:1,label:"Cada hora"},{value:6,label:"Cada 6 horas"},{value:12,label:"Cada 12 horas"},{value:24,label:"Cada d\xeda"},{value:168,label:"Cada semana"}]}onCloseModal(){this.closeModal.emit()}onSaveScheduler(){this.saveScheduler.emit()}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-scheduler-modal"]],inputs:{showModal:"showModal",schedulerFormData:"schedulerFormData",clients:"clients"},outputs:{closeModal:"closeModal",saveScheduler:"saveScheduler"},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[["class","fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4 animate-fade-in-up",4,"ngIf"],[1,"fixed","inset-0","bg-gray-900","bg-opacity-75","flex","items-center","justify-center","z-50","p-4","animate-fade-in-up"],[1,"bg-white","rounded-xl","shadow-xl","max-w-lg","w-full","mx-auto","overflow-hidden"],[1,"bg-indigo-600","px-6","py-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","text-white"],[1,"text-white/80","hover:text-white","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6","space-y-5"],[1,"space-y-2"],["for","client",1,"block","text-sm","font-medium","text-gray-700"],["id","client",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],["disabled","","selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","startDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","startDate",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],["for","endDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","endDate",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],["for","interval",1,"block","text-sm","font-medium","text-gray-700"],["id","interval",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],["for","dataType",1,"block","text-sm","font-medium","text-gray-700"],["id","dataType",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],["for","format",1,"block","text-sm","font-medium","text-gray-700"],["id","format",1,"w-full","rounded-lg","border","border-gray-300","py-2.5","px-3","text-gray-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","shadow-sm",3,"ngModel","ngModelChange"],[1,"bg-gray-50","px-6","py-4","border-t","border-gray-100","flex","justify-end","gap-3"],[1,"px-5","py-2.5","bg-white","hover:bg-gray-100","text-gray-700","rounded-lg","shadow-sm","transition-all","duration-200","font-medium","border","border-gray-200",3,"click"],[1,"px-5","py-2.5","bg-indigo-600","hover:bg-indigo-700","text-white","rounded-lg","shadow-sm","transition-all","duration-200","font-medium",3,"click"],[3,"value"]],template:function(r,o){1&r&&e.DNE(0,J,44,11,"div",0),2&r&&e.Y8G("ngIf",o.showModal)},dependencies:[c.MD,c.Sq,c.bT,a.YN,a.xH,a.y7,a.me,a.wz,a.BC,a.vS],encapsulation:2})}}return s})();function W(s,n){if(1&s){const t=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h3",4),e.EFF(4,"Confirmar Eliminaci\xf3n"),e.k0s(),e.j41(5,"button",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onCloseModal())}),e.qSk(),e.j41(6,"svg",6),e.nrm(7,"path",7),e.k0s()()(),e.joV(),e.j41(8,"div",8)(9,"div",9)(10,"div",10),e.qSk(),e.j41(11,"svg",11),e.nrm(12,"path",12),e.k0s()(),e.joV(),e.j41(13,"div")(14,"h4",13),e.EFF(15,"\xbfDesea eliminar este reporte?"),e.k0s(),e.j41(16,"p",14),e.EFF(17,"Esta acci\xf3n no se puede deshacer."),e.k0s()()(),e.j41(18,"p",15),e.EFF(19,"Reporte: "),e.j41(20,"span",16),e.EFF(21),e.k0s()()(),e.j41(22,"div",17)(23,"button",18),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onCloseModal())}),e.EFF(24," Cancelar "),e.k0s(),e.j41(25,"button",19),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onConfirmDelete())}),e.EFF(26," Eliminar "),e.k0s()()()()}if(2&s){const t=e.XpG();e.R7$(21),e.JRh(null==t.reportToDelete?null:t.reportToDelete.filename)}}let K=(()=>{class s{constructor(){this.showModal=!1,this.reportToDelete=null,this.closeModal=new e.bkB,this.confirmDelete=new e.bkB}onCloseModal(){this.closeModal.emit()}onConfirmDelete(){this.confirmDelete.emit()}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-delete-modal"]],inputs:{showModal:"showModal",reportToDelete:"reportToDelete"},outputs:{closeModal:"closeModal",confirmDelete:"confirmDelete"},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[["class","fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4 animate-fade-in-up",4,"ngIf"],[1,"fixed","inset-0","bg-gray-900","bg-opacity-75","flex","items-center","justify-center","z-50","p-4","animate-fade-in-up"],[1,"bg-white","rounded-xl","shadow-xl","max-w-md","w-full","mx-auto","overflow-hidden"],[1,"bg-red-600","px-6","py-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","text-white"],[1,"text-white/80","hover:text-white","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],[1,"flex","items-center","mb-5"],[1,"bg-red-100","p-3","rounded-full","mr-4","flex-shrink-0"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-6","w-6","text-red-600"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"text-lg","font-medium","text-gray-900"],[1,"text-sm","text-gray-500","mt-1"],[1,"text-center","text-gray-700"],[1,"font-semibold"],[1,"bg-gray-50","px-6","py-4","border-t","border-gray-100","flex","justify-end","gap-3"],[1,"px-5","py-2.5","bg-white","hover:bg-gray-100","text-gray-700","rounded-lg","shadow-sm","transition-all","duration-200","font-medium","border","border-gray-200",3,"click"],[1,"px-5","py-2.5","bg-red-600","hover:bg-red-700","text-white","rounded-lg","shadow-sm","transition-all","duration-200","font-medium",3,"click"]],template:function(r,o){1&r&&e.DNE(0,W,27,1,"div",0),2&r&&e.Y8G("ngIf",o.showModal)},dependencies:[c.MD,c.bT],encapsulation:2})}}return s})();var g=d(1626),u=d(8810),p=d(9437),b=d(5312);let Q=(()=>{class s{constructor(t){this.http=t,this.baseUrl=`${b.c.apiUrl}/api`}generateReport(t,r){return this.http.post(`${this.baseUrl}/clients/${t}/msad/reports`,r).pipe((0,p.W)(o=>(console.error("Error generating report:",o),(0,u.$)(()=>o))))}getClientReports(t,r,o){let i=new g.Nl;return r&&(i=i.set("format",r)),o&&(i=i.set("data_type",o)),this.http.get(`${this.baseUrl}/clients/${t}/msad/reports`,{params:i}).pipe((0,p.W)(l=>(console.error("Error getting client reports:",l),(0,u.$)(()=>l))))}getAllReports(t,r){let o=new g.Nl;return t&&(o=o.set("format",t)),r&&(o=o.set("data_type",r)),this.http.get(`${this.baseUrl}/msad/reports`,{params:o}).pipe((0,p.W)(i=>(console.error("Error getting all reports:",i),(0,u.$)(()=>i))))}getReportDownloadUrl(t,r){return`${this.baseUrl}/clients/${t}/msad/reports/download/${r}`}deleteReport(t,r){return this.http.delete(`${this.baseUrl}/clients/${t}/msad/reports/${r}`).pipe((0,p.W)(o=>(console.error("Error deleting report:",o),(0,u.$)(()=>o))))}static{this.\u0275fac=function(r){return new(r||s)(e.KVO(g.Qq))}}static{this.\u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})(),Z=(()=>{class s{constructor(t){this.http=t,this.baseUrl=`${b.c.apiUrl}/api`}startScheduler(t){return this.http.post(`${this.baseUrl}/msad/reports/scheduler/start`,t).pipe((0,p.W)(r=>(console.error("Error starting scheduler:",r),(0,u.$)(()=>r))))}stopScheduler(t){return this.http.post(`${this.baseUrl}/msad/reports/scheduler/stop`,{client_id:t}).pipe((0,p.W)(r=>(console.error("Error stopping scheduler:",r),(0,u.$)(()=>r))))}getSchedulerStatus(t){let r=(new g.Nl).set("client_id",t);return this.http.get(`${this.baseUrl}/msad/reports/scheduler/status`,{params:r}).pipe((0,p.W)(o=>(console.error("Error getting scheduler status:",o),(0,u.$)(()=>o))))}static{this.\u0275fac=function(r){return new(r||s)(e.KVO(g.Qq))}}static{this.\u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var ee=d(3091),te=d(5129);function oe(s,n){if(1&s&&(e.qSk(),e.joV(),e.j41(0,"span",38),e.EFF(1),e.k0s()),2&s){const t=e.XpG();e.R7$(1),e.SpI(" ",t.getActiveSchedulersCount()," ")}}function re(s,n){1&s&&(e.qSk(),e.j41(0,"svg",39),e.nrm(1,"path",40),e.k0s())}function se(s,n){1&s&&(e.qSk(),e.j41(0,"svg",39),e.nrm(1,"path",14),e.k0s())}function ne(s,n){1&s&&(e.j41(0,"div",41),e.nrm(1,"div",42),e.j41(2,"span",43),e.EFF(3,"Cargando datos..."),e.k0s()())}function ie(s,n){if(1&s&&(e.j41(0,"div",44),e.qSk(),e.j41(1,"svg",45),e.nrm(2,"path",46),e.k0s(),e.joV(),e.j41(3,"div")(4,"p",47),e.EFF(5),e.k0s(),e.j41(6,"p",48),e.EFF(7,"Int\xe9ntelo nuevamente o contacte al administrador."),e.k0s()()()),2&s){const t=e.XpG();e.R7$(5),e.JRh(t.error)}}function le(s,n){if(1&s&&(e.j41(0,"div",49),e.qSk(),e.j41(1,"svg",50),e.nrm(2,"path",51),e.k0s(),e.joV(),e.j41(3,"div")(4,"p",47),e.EFF(5),e.k0s()()()),2&s){const t=e.XpG();e.R7$(5),e.JRh(t.successMessage)}}function ae(s,n){1&s&&(e.qSk(),e.j41(0,"svg",83),e.nrm(1,"rect",84),e.k0s())}function de(s,n){1&s&&(e.qSk(),e.j41(0,"svg",85),e.nrm(1,"circle",86),e.k0s())}function ce(s,n){1&s&&(e.qSk(),e.j41(0,"svg",87),e.nrm(1,"circle",86),e.k0s())}function ue(s,n){1&s&&(e.qSk(),e.j41(0,"svg",88),e.nrm(1,"rect",84),e.k0s())}function pe(s,n){1&s&&(e.qSk(),e.j41(0,"svg",89),e.nrm(1,"polygon",90),e.k0s())}const he=function(s,n,t){return{"bg-yellow-100 text-yellow-800":s,"bg-indigo-100 text-indigo-800":n,"bg-pink-100 text-pink-800":t}};function ge(s,n){if(1&s){const t=e.RV6();e.j41(0,"tr",65)(1,"td",66),e.EFF(2),e.k0s(),e.j41(3,"td",67),e.EFF(4),e.k0s(),e.j41(5,"td",68)(6,"span",69),e.DNE(7,ae,2,0,"svg",70),e.DNE(8,de,2,0,"svg",71),e.EFF(9),e.k0s()(),e.j41(10,"td",68)(11,"span",69),e.DNE(12,ce,2,0,"svg",72),e.DNE(13,ue,2,0,"svg",73),e.DNE(14,pe,2,0,"svg",74),e.EFF(15),e.nI1(16,"titlecase"),e.k0s()(),e.j41(17,"td",75),e.EFF(18),e.k0s(),e.j41(19,"td",75),e.EFF(20),e.nI1(21,"date"),e.k0s(),e.j41(22,"td",76)(23,"div",77)(24,"button",78),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(3);return e.Njj(l.downloadReport(i))}),e.qSk(),e.j41(25,"svg",79),e.nrm(26,"path",80),e.k0s()(),e.joV(),e.j41(27,"button",81),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(3);return e.Njj(l.openDeleteModal(i))}),e.qSk(),e.j41(28,"svg",79),e.nrm(29,"path",82),e.k0s()()()()()}if(2&s){const t=n.$implicit,r=e.XpG(3);e.R7$(2),e.SpI(" ",t.report_id," "),e.R7$(2),e.JRh(r.getClientNameById(t.client_id||"")),e.R7$(2),e.Y8G("ngClass","csv"===t.format?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),e.R7$(1),e.Y8G("ngIf","csv"===t.format),e.R7$(1),e.Y8G("ngIf","json"===t.format),e.R7$(1),e.SpI(" ",null==t.format?null:t.format.toUpperCase()," "),e.R7$(2),e.Y8G("ngClass",e.sMw(18,he,"events"===t.data_type,"sensors"===t.data_type,"actuators"===t.data_type)),e.R7$(1),e.Y8G("ngIf","sensors"===t.data_type),e.R7$(1),e.Y8G("ngIf","events"===t.data_type),e.R7$(1),e.Y8G("ngIf","actuators"===t.data_type),e.R7$(1),e.SpI(" ",t.data_type?e.bMT(16,13,t.data_type):"N/A"," "),e.R7$(3),e.SpI(" ",r.formatFileSize(t.size)," "),e.R7$(2),e.JRh(e.i5U(21,15,t.created_at,"medium"))}}function me(s,n){if(1&s&&(e.j41(0,"div",54)(1,"div",55)(2,"h2",56),e.EFF(3,"Reportes Disponibles"),e.k0s(),e.j41(4,"p",57),e.EFF(5,"Lista de todos los reportes generados"),e.k0s()(),e.j41(6,"div",58)(7,"table",59)(8,"thead",60)(9,"tr")(10,"th",61),e.EFF(11,"ID"),e.k0s(),e.j41(12,"th",61),e.EFF(13,"Cultivo"),e.k0s(),e.j41(14,"th",61),e.EFF(15,"Formato"),e.k0s(),e.j41(16,"th",61),e.EFF(17,"Tipo"),e.k0s(),e.j41(18,"th",61),e.EFF(19,"Tama\xf1o"),e.k0s(),e.j41(20,"th",61),e.EFF(21,"Fecha"),e.k0s(),e.j41(22,"th",62),e.EFF(23,"Acciones"),e.k0s()()(),e.j41(24,"tbody",63),e.DNE(25,ge,30,22,"tr",64),e.k0s()()()()),2&s){const t=e.XpG(2);e.R7$(25),e.Y8G("ngForOf",t.reports)}}function fe(s,n){if(1&s){const t=e.RV6();e.j41(0,"div",91)(1,"div",92)(2,"div",93),e.qSk(),e.j41(3,"svg",94),e.nrm(4,"path",95),e.k0s()(),e.joV(),e.j41(5,"h2",96),e.EFF(6,"No hay reportes disponibles"),e.k0s(),e.j41(7,"p",97),e.EFF(8,"Genere un nuevo reporte o ajuste los filtros de b\xfasqueda para ver resultados"),e.k0s(),e.j41(9,"button",98),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.openGenerateReportModal())}),e.qSk(),e.j41(10,"svg",12),e.nrm(11,"path",26),e.k0s(),e.EFF(12," Generar Nuevo Reporte "),e.k0s()()()}}function _e(s,n){if(1&s&&(e.j41(0,"div"),e.DNE(1,me,26,1,"div",52),e.DNE(2,fe,13,0,"div",53),e.k0s()),2&s){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.reports.length>0),e.R7$(1),e.Y8G("ngIf",!t.isLoading&&0===t.reports.length)}}function ve(s,n){if(1&s&&(e.qSk(),e.joV(),e.j41(0,"div",18)(1,"div",116)(2,"div")(3,"p",117),e.EFF(4,"Frecuencia"),e.k0s(),e.j41(5,"p",118),e.EFF(6),e.k0s()(),e.j41(7,"div")(8,"p",117),e.EFF(9,"Formato"),e.k0s(),e.j41(10,"p",118),e.EFF(11),e.k0s()(),e.j41(12,"div",119)(13,"p",117),e.EFF(14,"Rango de Fechas"),e.k0s(),e.j41(15,"p",118),e.EFF(16),e.k0s()(),e.j41(17,"div")(18,"p",117),e.EFF(19,"Tipo de datos"),e.k0s(),e.j41(20,"p",118),e.EFF(21),e.nI1(22,"titlecase"),e.k0s()(),e.j41(23,"div")(24,"p",117),e.EFF(25,"\xdaltima ejecuci\xf3n"),e.k0s(),e.j41(26,"p",118),e.EFF(27),e.k0s()()(),e.j41(28,"div",120),e.qSk(),e.j41(29,"svg",121),e.nrm(30,"path",14),e.k0s(),e.joV(),e.j41(31,"div")(32,"p",122),e.EFF(33,"Pr\xf3xima ejecuci\xf3n"),e.k0s(),e.j41(34,"p",123),e.EFF(35),e.k0s()()()()),2&s){const t=n.ngIf,r=e.XpG().$implicit,o=e.XpG(3);e.R7$(6),e.JRh(o.getIntervalLabel(t.interval_hours||24)),e.R7$(5),e.JRh((null==t||null==t.format?null:t.format.toUpperCase())||"N/A"),e.R7$(5),e.Lme(" ",t.start_date||"N/A"," - ",t.end_date||"N/A"," "),e.R7$(5),e.JRh(e.bMT(22,7,t.data_type)),e.R7$(6),e.JRh(o.formatDate(r.value.last_run)),e.R7$(8),e.JRh(o.formatNextRun(r.value.next_run))}}function be(s,n){if(1&s){const t=e.RV6();e.j41(0,"div",108)(1,"div",109)(2,"div",110),e.nrm(3,"div",111),e.j41(4,"h3",112),e.EFF(5),e.k0s()(),e.j41(6,"button",113),e.bIt("click",function(){const i=e.eBV(t).$implicit,l=e.XpG(3);return e.Njj(l.stopScheduler(i.key))}),e.qSk(),e.j41(7,"svg",25),e.nrm(8,"path",114),e.k0s()()(),e.DNE(9,ve,36,9,"div",115),e.k0s()}if(2&s){const t=n.$implicit,r=e.XpG(3);e.R7$(5),e.JRh(r.getClientNameById(t.key)),e.R7$(4),e.Y8G("ngIf",t.value.config)}}function xe(s,n){if(1&s&&(e.j41(0,"div",105)(1,"h2",29),e.EFF(2,"Programadores Activos"),e.k0s(),e.j41(3,"div",106),e.DNE(4,be,10,2,"div",107),e.nI1(5,"keyvalue"),e.k0s()()),2&s){const t=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",e.bMT(5,1,t.filteredSchedulerStatuses))}}function Fe(s,n){1&s&&(e.j41(0,"p",97),e.EFF(1,"Configure un programador para generar reportes autom\xe1ticamente para sus cultivos"),e.k0s())}function we(s,n){1&s&&(e.j41(0,"p",97),e.EFF(1,"No hay programadores que coincidan con los filtros seleccionados"),e.k0s())}function ye(s,n){if(1&s){const t=e.RV6();e.j41(0,"div",91)(1,"div",92)(2,"div",93),e.qSk(),e.j41(3,"svg",94),e.nrm(4,"path",124),e.k0s()(),e.joV(),e.j41(5,"h2",96),e.EFF(6,"No hay programadores activos"),e.k0s(),e.DNE(7,Fe,2,0,"p",125),e.DNE(8,we,2,0,"p",125),e.j41(9,"button",98),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.openSchedulerModal())}),e.qSk(),e.j41(10,"svg",12),e.nrm(11,"path",26),e.k0s(),e.EFF(12," Configurar Programador "),e.k0s()()()}if(2&s){const t=e.XpG(2);e.R7$(7),e.Y8G("ngIf",0===t.schedulerStatuses.size),e.R7$(1),e.Y8G("ngIf",t.schedulerStatuses.size>0)}}function Ce(s,n){if(1&s&&(e.j41(0,"div"),e.DNE(1,xe,6,3,"div",99),e.DNE(2,ye,13,2,"div",53),e.j41(3,"div",100)(4,"h2",29),e.EFF(5,"Informaci\xf3n sobre programadores"),e.k0s(),e.j41(6,"div",101)(7,"h3",102),e.EFF(8,"\xbfC\xf3mo funcionan los programadores de reportes?"),e.k0s(),e.j41(9,"p",103),e.EFF(10,"Los programadores autom\xe1ticos generan reportes con la frecuencia configurada, utilizando el per\xedodo y tipo de datos seleccionados."),e.k0s(),e.j41(11,"ul",104)(12,"li"),e.EFF(13,"Cada cultivo puede tener un programador activo"),e.k0s(),e.j41(14,"li"),e.EFF(15,'Los reportes generados estar\xe1n disponibles en la secci\xf3n "Reportes Manuales"'),e.k0s(),e.j41(16,"li"),e.EFF(17,"Las programaciones persisten incluso al reiniciar el servidor"),e.k0s(),e.j41(18,"li"),e.EFF(19,"Para detener un programador, utilice el bot\xf3n de detener en la tarjeta correspondiente"),e.k0s()()()()()),2&s){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.filteredSchedulerStatuses.size>0),e.R7$(1),e.Y8G("ngIf",0===t.filteredSchedulerStatuses.size)}}const x=function(s,n){return{"bg-indigo-50 text-indigo-700 border-indigo-500":s,"text-gray-500 hover:text-gray-700 hover:bg-gray-50":n}};let ke=(()=>{class s{get filteredClientsForModal(){return this.clients.filter(t=>""!==t.client_id)}constructor(t,r,o,i){this.reportsService=t,this.schedulerService=r,this.router=o,this.authService=i,this.reports=[],this.isLoading=!1,this.error=null,this.successMessage=null,this.showReportModal=!1,this.showSchedulerModal=!1,this.showDeleteModal=!1,this.reportToDelete=null,this.reportFormData={start_date:"",end_date:"",data_type:"sensors",format:"json"},this.schedulerFormData={interval_hours:24,client_id:"",start_date:"",end_date:"",data_type:"sensors",format:"json"},this.schedulerStatuses=new Map,this.filteredSchedulerStatuses=new Map,this.selectedDataType="",this.selectedFormat="",this.selectedClient="",this.clients=[],this.activeView="reports",this.STORAGE_KEY="currentClientId",this.destroy$=new F.B}ngOnInit(){this.selectedClient=this.getCurrentClientId(),this.loadClients(),this.loadReports(),this.checkSchedulersStatus(),function I(s=0,n=v){return s<0&&(s=0),function T(s=0,n,t=R){let r=-1;return null!=n&&((0,D.m)(n)?t=n:r=n),new E.c(o=>{let i=function S(s){return s instanceof Date&&!isNaN(s)}(s)?+s-t.now():s;i<0&&(i=0);let l=0;return t.schedule(function(){o.closed||(o.next(l++),0<=r?this.schedule(void 0,r):o.complete())},i)})}(s,s,n)}(3e4).pipe((0,$.Q)(this.destroy$),(0,G.n)(()=>"schedulers"===this.activeView?new Promise(t=>{this.checkSchedulersStatus(),t(null)}):Promise.resolve(null))).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}toggleView(t){this.activeView=t,"schedulers"===t?this.checkSchedulersStatus():this.loadReports()}loadClients(){this.isLoading=!0,this.authService.getClients().subscribe({next:t=>{this.clients=[{client_id:"",name:"Todos los clientes"},...t],this.isLoading=!1},error:t=>{console.error("Error loading clients:",t),this.error="Error al cargar los clientes.",this.clients=[{client_id:"",name:"Todos los clientes"}],this.isLoading=!1}})}checkSchedulersStatus(){if(this.isLoading=!0,this.error=null,this.schedulerStatuses.clear(),!this.clients||this.clients.length<=1)return void(this.isLoading=!1);let t=0;const r=this.clients.filter(o=>""!==o.client_id);0!==r.length?r.forEach(o=>{this.schedulerService.getSchedulerStatus(o.client_id).subscribe({next:i=>{i.success&&i.is_running&&this.schedulerStatuses.set(o.client_id,i),t++,t===r.length&&(this.applySchedulerFilters(),this.isLoading=!1)},error:()=>{t++,t===r.length&&(this.applySchedulerFilters(),this.isLoading=!1)}})}):this.isLoading=!1}applySchedulerFilters(){if(this.filteredSchedulerStatuses=new Map(this.schedulerStatuses),this.selectedClient){const t=new Map;if(this.schedulerStatuses.has(this.selectedClient)){const r=this.schedulerStatuses.get(this.selectedClient);r&&t.set(this.selectedClient,r)}this.filteredSchedulerStatuses=t}if(this.selectedDataType){const t=new Map;this.filteredSchedulerStatuses.forEach((r,o)=>{r.config?.data_type===this.selectedDataType&&t.set(o,r)}),this.filteredSchedulerStatuses=t}if(this.selectedFormat){const t=new Map;this.filteredSchedulerStatuses.forEach((r,o)=>{r.config?.format===this.selectedFormat&&t.set(o,r)}),this.filteredSchedulerStatuses=t}}loadReports(){this.isLoading=!0,this.error=null,(this.selectedClient?this.reportsService.getClientReports(this.selectedClient,this.selectedFormat,this.selectedDataType):this.reportsService.getAllReports(this.selectedFormat,this.selectedDataType)).subscribe({next:r=>{r.success?this.reports=r.reports||[]:this.error=r.error||"Error al cargar los reportes",this.isLoading=!1},error:r=>{console.error("Error loading reports:",r),this.error="Error al cargar los reportes",this.isLoading=!1}})}formatDateForInput(t){return t.toISOString().split("T")[0]}openGenerateReportModal(){const t=this.formatDateForInput(new Date);this.reportFormData={start_date:t,end_date:t,data_type:"sensors",format:"json"},this.showReportModal=!0}closeReportModal(){this.showReportModal=!1}generateReport(){this.selectedClient?(this.isLoading=!0,this.reportsService.generateReport(this.selectedClient,this.reportFormData).subscribe({next:t=>{this.error=null,this.successMessage=null,t.success?(this.successMessage=t.message||"Reporte generado con \xe9xito.",this.loadReports(),this.showReportModal=!1):this.error=t.error||"Error al generar el reporte",this.isLoading=!1,setTimeout(()=>this.successMessage=null,5e3)},error:t=>{console.error("Error generating report:",t),this.error="Error al generar el reporte",this.isLoading=!1,this.successMessage=null}})):this.error="Debe seleccionar un cliente para generar el reporte"}openSchedulerModal(){const t=this.formatDateForInput(new Date),r=this.getCurrentClientId()||"";this.schedulerFormData={interval_hours:24,client_id:r,start_date:t,end_date:t,data_type:"sensors",format:"json"},this.schedulerFormData.client_id=this.clients.some(o=>o.client_id===r)?r:"",this.showSchedulerModal=!0}closeSchedulerModal(){this.showSchedulerModal=!1}saveScheduler(){this.schedulerFormData.client_id?(this.isLoading=!0,this.schedulerService.startScheduler(this.schedulerFormData).subscribe({next:t=>{this.error=null,this.successMessage=null,t.success?(this.successMessage=t.message||"Programador configurado con \xe9xito.",this.checkSchedulersStatus(),this.showSchedulerModal=!1):this.error=t.error||"Error al configurar el programador",this.isLoading=!1,setTimeout(()=>this.successMessage=null,5e3)},error:t=>{console.error("Error saving scheduler:",t),this.error="Error al configurar el programador",this.isLoading=!1,this.successMessage=null}})):this.error="Debe seleccionar un cliente para el programador"}stopScheduler(t){this.isLoading=!0,this.schedulerService.stopScheduler(t).subscribe({next:r=>{this.error=null,this.successMessage=null,r.success?(this.successMessage=r.message||"Programador detenido con \xe9xito.",this.checkSchedulersStatus()):this.error=r.error||"Error al detener el programador",this.isLoading=!1,setTimeout(()=>this.successMessage=null,5e3)},error:r=>{console.error("Error stopping scheduler:",r),this.error="Error al detener el programador",this.isLoading=!1,this.successMessage=null}})}openDeleteModal(t){this.reportToDelete=t,this.showDeleteModal=!0}closeDeleteModal(){this.showDeleteModal=!1,this.reportToDelete=null}confirmDeleteReport(){this.reportToDelete&&this.reportToDelete.client_id&&this.reportToDelete.report_id?(this.isLoading=!0,this.reportsService.deleteReport(this.reportToDelete.client_id,this.reportToDelete.report_id).subscribe({next:t=>{this.error=null,this.successMessage=null,t.success?(this.successMessage=t.message||"Reporte eliminado con \xe9xito.",this.loadReports(),this.showDeleteModal=!1,this.reportToDelete=null):this.error=t.error||"Error al eliminar el reporte",this.isLoading=!1,setTimeout(()=>this.successMessage=null,5e3)},error:t=>{console.error("Error deleting report:",t),this.error="Error al eliminar el reporte",this.isLoading=!1,this.successMessage=null}})):this.error="No se puede eliminar el reporte"}getCurrentClientId(){return localStorage.getItem(this.STORAGE_KEY)||""}getCurrentClientName(){const t=this.clients.find(r=>r.client_id===this.selectedClient);return t?t.name:""}getClientNameById(t){const r=this.clients.find(o=>o.client_id===t);return r?r.name:t}applyFilters(){"reports"===this.activeView?this.loadReports():this.applySchedulerFilters()}clearFilters(){this.selectedDataType="",this.selectedFormat="",this.selectedClient=this.getCurrentClientId()||"",this.applyFilters()}downloadReport(t){if(!t||!t.client_id||!t.filename)return void(this.error="No se puede descargar el reporte seleccionado.");const r=this.reportsService.getReportDownloadUrl(t.client_id,t.filename),o="json"===t.format?"application/json":"text/csv",i=document.createElement("a");i.style.display="none",document.body.appendChild(i),fetch(r).then(l=>{if(!l.ok)throw new Error("Error al descargar el archivo");return l.blob()}).then(l=>{const f=window.URL.createObjectURL(new Blob([l],{type:o}));i.href=f,i.download=t.filename,i.click(),window.URL.revokeObjectURL(f)}).catch(l=>{console.error("Error downloading file:",l),this.error=`Error al descargar el archivo. ${l.message||""}`}).finally(()=>{document.body.removeChild(i)})}formatDate(t){return t?new Date(t).toLocaleString():"N/A"}formatNextRun(t){if(!t)return"N/A";const r=new Date(t),o=new Date,i=r.getTime()-o.getTime();return i<0?"En progreso":`En ${Math.floor(i/36e5)}h ${Math.floor(i%36e5/6e4)}m`}formatFileSize(t){if(0===t)return"0 Bytes";const i=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,i)).toFixed(2))+" "+["Bytes","KB","MB","GB"][i]}getIntervalLabel(t){const o=[{value:1,label:"Cada hora"},{value:6,label:"Cada 6 horas"},{value:12,label:"Cada 12 horas"},{value:24,label:"Cada d\xeda"},{value:168,label:"Cada semana"}].find(i=>i.value===t);return o?o.label:`${t} horas`}getActiveSchedulersCount(){return this.filteredSchedulerStatuses.size}hasActiveScheduler(){return!!this.selectedClient&&this.schedulerStatuses.has(this.selectedClient)}static{this.\u0275fac=function(r){return new(r||s)(e.rXU(Q),e.rXU(Z),e.rXU(ee.Ix),e.rXU(te.u))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-reports"]],standalone:!0,features:[e.aNF],decls:54,vars:35,consts:[[1,"min-h-screen","bg-gradient-to-br","from-gray-50","to-gray-100","p-4","md:p-6"],[1,"max-w-7xl","mx-auto"],[1,"flex","flex-col","md:flex-row","md:items-center","justify-between","mb-8","gap-4"],[1,"text-2xl","font-bold","tracking-tight","text-gray-900","mb-1"],[1,"text-sm","text-gray-500"],[1,"bg-indigo-50","px-5","py-4","rounded-xl","shadow-sm","border","border-indigo-100","flex","items-center"],[1,"flex","flex-col"],[1,"text-sm","font-medium","text-indigo-600","mb-1"],[1,"text-lg","font-bold","text-indigo-700"],[1,"bg-white","rounded-xl","shadow-sm","overflow-hidden","border","border-gray-100","mb-8"],[1,"flex","border-b","border-gray-100"],[1,"flex","items-center","px-5","py-4","text-sm","font-medium","border-b-2","transition-all","duration-200",3,"ngClass","click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","mr-2"],["fill-rule","evenodd","d","M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z","clip-rule","evenodd"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule","evenodd"],["class","ml-2 px-2 py-0.5 bg-green-100 text-green-800 text-xs font-semibold rounded-full",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-8"],[1,"bg-white","rounded-xl","shadow-sm","overflow-hidden","border","border-gray-100"],[1,"p-5"],[1,"flex","items-center","mb-3"],[1,"flex-shrink-0","bg-indigo-100","p-2","rounded-lg"],["xmlns","http://www.w3.org/2000/svg","class","h-6 w-6 text-indigo-600","viewBox","0 0 20 20","fill","currentColor",4,"ngIf"],[1,"text-lg","font-semibold","text-gray-900","ml-3"],[1,"text-sm","text-gray-500","mb-4"],[1,"w-full","px-4","py-2.5","bg-indigo-600","hover:bg-indigo-700","text-white","rounded-lg","transition-all","duration-200","flex","items-center","justify-center","gap-2","font-medium",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5"],["fill-rule","evenodd","d","M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule","evenodd"],[1,"md:col-span-3"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-5","h-full"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[3,"selectedClient","selectedDataType","selectedFormat","clients","selectedClientChange","selectedDataTypeChange","selectedFormatChange","filtersCleared"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","bg-red-50 p-5 rounded-xl border border-red-100 text-red-700 mb-8 flex items-start gap-3",4,"ngIf"],["class","bg-green-50 p-5 rounded-xl border border-green-100 text-green-700 mb-8 flex items-start gap-3 animate-fade-in-up",4,"ngIf"],[4,"ngIf"],[3,"showModal","reportFormData","closeModal","generateReport"],[3,"showModal","schedulerFormData","clients","closeModal","saveScheduler"],[3,"showModal","reportToDelete","closeModal","confirmDelete"],[1,"ml-2","px-2","py-0.5","bg-green-100","text-green-800","text-xs","font-semibold","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-6","w-6","text-indigo-600"],["fill-rule","evenodd","d","M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V8z","clip-rule","evenodd"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-t-2","border-r-2","border-indigo-600","mb-4"],[1,"ml-4","text-gray-700","font-medium"],[1,"bg-red-50","p-5","rounded-xl","border","border-red-100","text-red-700","mb-8","flex","items-start","gap-3"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","mt-0.5","text-red-500","flex-shrink-0"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"font-medium"],[1,"text-sm","mt-1"],[1,"bg-green-50","p-5","rounded-xl","border","border-green-100","text-green-700","mb-8","flex","items-start","gap-3","animate-fade-in-up"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","mt-0.5","text-green-500","flex-shrink-0"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],["class","bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",4,"ngIf"],["class","bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","overflow-hidden"],[1,"px-5","py-4","border-b","border-gray-100"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-500","mt-1"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],["scope","col",1,"px-6","py-3.5","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],["scope","col",1,"px-6","py-3.5","text-center","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-100"],["class","hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50","transition-colors"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-indigo-600","group-hover:text-indigo-800"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap"],[1,"inline-flex","items-center","px-2","py-0.5","rounded","text-xs","font-semibold",3,"ngClass"],["class","h-3 w-3 mr-1 text-green-500","fill","currentColor","viewBox","0 0 20 20",4,"ngIf"],["class","h-3 w-3 mr-1 text-blue-500","fill","currentColor","viewBox","0 0 20 20",4,"ngIf"],["class","h-3 w-3 mr-1 text-indigo-500","fill","currentColor","viewBox","0 0 20 20",4,"ngIf"],["class","h-3 w-3 mr-1 text-yellow-500","fill","currentColor","viewBox","0 0 20 20",4,"ngIf"],["class","h-3 w-3 mr-1 text-pink-500","fill","currentColor","viewBox","0 0 20 20",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap","text-xs","text-gray-700"],[1,"px-6","py-4","whitespace-nowrap","text-center"],[1,"flex","items-center","justify-center","gap-2"],["title","Descargar","tabindex","0",1,"p-2","rounded","bg-blue-50","hover:bg-blue-100","text-blue-700","focus:outline-none",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"],["title","Eliminar","tabindex","0",1,"p-2","rounded","bg-red-50","hover:bg-red-100","text-red-700","focus:outline-none",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],["fill","currentColor","viewBox","0 0 20 20",1,"h-3","w-3","mr-1","text-green-500"],["width","20","height","20","rx","3"],["fill","currentColor","viewBox","0 0 20 20",1,"h-3","w-3","mr-1","text-blue-500"],["cx","10","cy","10","r","10"],["fill","currentColor","viewBox","0 0 20 20",1,"h-3","w-3","mr-1","text-indigo-500"],["fill","currentColor","viewBox","0 0 20 20",1,"h-3","w-3","mr-1","text-yellow-500"],["fill","currentColor","viewBox","0 0 20 20",1,"h-3","w-3","mr-1","text-pink-500"],["points","10,2 2,18 18,18"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-8","text-center"],[1,"max-w-md","mx-auto"],[1,"bg-indigo-100","mx-auto","h-20","w-20","rounded-full","flex","items-center","justify-center","mb-4"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-10","w-10","text-indigo-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-500","mb-6"],[1,"px-6","py-2.5","bg-indigo-600","hover:bg-indigo-700","text-white","rounded-lg","shadow-sm","transition-all","duration-200","font-medium","inline-flex","items-center",3,"click"],["class","mb-8",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-5","mt-8"],[1,"bg-blue-50","p-4","rounded-lg","border","border-blue-100"],[1,"font-medium","text-blue-800","mb-2"],[1,"text-sm","text-blue-700","mb-2"],[1,"list-disc","pl-5","text-sm","text-blue-700","space-y-1"],[1,"mb-8"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],["class","bg-white rounded-xl shadow-sm border border-emerald-100 overflow-hidden",4,"ngFor","ngForOf"],[1,"bg-white","rounded-xl","shadow-sm","border","border-emerald-100","overflow-hidden"],[1,"bg-emerald-50","px-5","py-3","border-b","border-emerald-100","flex","justify-between","items-center"],[1,"flex","items-center"],[1,"h-3","w-3","bg-emerald-500","rounded-full","mr-2","animate-pulse"],[1,"font-medium","text-emerald-800"],[1,"p-1.5","bg-white","rounded","text-red-600","hover:bg-red-50","transition-colors",3,"click"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z","clip-rule","evenodd"],["class","p-5",4,"ngIf"],[1,"grid","grid-cols-2","gap-4","mb-4"],[1,"text-xs","text-gray-500","mb-1"],[1,"text-sm","font-medium","text-gray-800"],[1,"col-span-2"],[1,"bg-blue-50","p-3","rounded-lg","border","border-blue-100","flex","items-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","text-blue-500","mr-2","flex-shrink-0"],[1,"text-xs","text-blue-800","mb-0.5"],[1,"text-sm","font-semibold","text-blue-900"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],["class","text-gray-500 mb-6",4,"ngIf"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),e.EFF(5,"Sistema de Reportes MSAD"),e.k0s(),e.j41(6,"p",4),e.EFF(7,"Visualice, descargue y configure reportes autom\xe1ticos para sus cultivos"),e.k0s()(),e.j41(8,"div",5)(9,"div",6)(10,"span",7),e.EFF(11,"Cultivo activo"),e.k0s(),e.j41(12,"span",8),e.EFF(13),e.k0s()()()(),e.j41(14,"div",9)(15,"div",10)(16,"button",11),e.bIt("click",function(){return o.toggleView("reports")}),e.qSk(),e.j41(17,"svg",12),e.nrm(18,"path",13),e.k0s(),e.EFF(19," Reportes Manuales "),e.k0s(),e.joV(),e.j41(20,"button",11),e.bIt("click",function(){return o.toggleView("schedulers")}),e.qSk(),e.j41(21,"svg",12),e.nrm(22,"path",14),e.k0s(),e.EFF(23," Programadores Autom\xe1ticos "),e.DNE(24,oe,2,1,"span",15),e.k0s()()(),e.joV(),e.j41(25,"div",16)(26,"div",17)(27,"div",18)(28,"div",19)(29,"div",20),e.DNE(30,re,2,0,"svg",21),e.DNE(31,se,2,0,"svg",21),e.k0s(),e.j41(32,"h2",22),e.EFF(33),e.k0s()(),e.j41(34,"p",23),e.EFF(35),e.k0s(),e.j41(36,"button",24),e.bIt("click",function(){return"reports"===o.activeView?o.openGenerateReportModal():o.openSchedulerModal()}),e.qSk(),e.j41(37,"svg",25),e.nrm(38,"path",26),e.k0s(),e.joV(),e.j41(39,"span"),e.EFF(40),e.k0s()()()(),e.j41(41,"div",27)(42,"div",28)(43,"h2",29),e.EFF(44,"Filtros de B\xfasqueda"),e.k0s(),e.j41(45,"app-report-filters",30),e.bIt("selectedClientChange",function(l){return o.selectedClient=l,o.applyFilters()})("selectedDataTypeChange",function(l){return o.selectedDataType=l,o.applyFilters()})("selectedFormatChange",function(l){return o.selectedFormat=l,o.applyFilters()})("filtersCleared",function(){return o.clearFilters()}),e.k0s()()()(),e.DNE(46,ne,4,0,"div",31),e.DNE(47,ie,8,1,"div",32),e.DNE(48,le,6,1,"div",33),e.DNE(49,_e,3,2,"div",34),e.DNE(50,Ce,20,2,"div",34),e.k0s()(),e.j41(51,"app-report-modal",35),e.bIt("closeModal",function(){return o.closeReportModal()})("generateReport",function(){return o.generateReport()}),e.k0s(),e.j41(52,"app-scheduler-modal",36),e.bIt("closeModal",function(){return o.closeSchedulerModal()})("saveScheduler",function(){return o.saveScheduler()}),e.k0s(),e.j41(53,"app-delete-modal",37),e.bIt("closeModal",function(){return o.closeDeleteModal()})("confirmDelete",function(){return o.confirmDeleteReport()}),e.k0s()),2&r&&(e.R7$(13),e.JRh(o.getCurrentClientName()||"Sin cultivo seleccionado"),e.R7$(3),e.AVh("border-transparent","reports"!==o.activeView),e.Y8G("ngClass",e.l_i(29,x,"reports"===o.activeView,"reports"!==o.activeView)),e.R7$(4),e.AVh("border-transparent","schedulers"!==o.activeView),e.Y8G("ngClass",e.l_i(32,x,"schedulers"===o.activeView,"schedulers"!==o.activeView)),e.R7$(4),e.Y8G("ngIf",o.getActiveSchedulersCount()>0),e.R7$(6),e.Y8G("ngIf","reports"===o.activeView),e.R7$(1),e.Y8G("ngIf","schedulers"===o.activeView),e.R7$(2),e.SpI(" ","reports"===o.activeView?"Nuevo Reporte":"Nuevo Programador"," "),e.R7$(2),e.SpI(" ","reports"===o.activeView?"Cree un nuevo reporte con los datos y formato deseado":"Configure la generaci\xf3n autom\xe1tica de reportes peri\xf3dicos"," "),e.R7$(5),e.JRh("reports"===o.activeView?"Generar Reporte":"Configurar Programador"),e.R7$(5),e.Y8G("selectedClient",o.selectedClient)("selectedDataType",o.selectedDataType)("selectedFormat",o.selectedFormat)("clients",o.clients),e.R7$(1),e.Y8G("ngIf",o.isLoading),e.R7$(1),e.Y8G("ngIf",o.error),e.R7$(1),e.Y8G("ngIf",o.successMessage),e.R7$(1),e.Y8G("ngIf","reports"===o.activeView&&!o.isLoading),e.R7$(1),e.Y8G("ngIf","schedulers"===o.activeView&&!o.isLoading),e.R7$(1),e.Y8G("showModal",o.showReportModal)("reportFormData",o.reportFormData),e.R7$(1),e.Y8G("showModal",o.showSchedulerModal)("schedulerFormData",o.schedulerFormData)("clients",o.filteredClientsForModal),e.R7$(1),e.Y8G("showModal",o.showDeleteModal)("reportToDelete",o.reportToDelete))},dependencies:[c.MD,c.YU,c.Sq,c.bT,c.PV,c.vh,c.lG,a.YN,Y,O,P,K],encapsulation:2})}}return s})()}}]);